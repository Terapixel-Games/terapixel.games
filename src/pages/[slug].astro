---
import BaseLayout from '../layouts/BaseLayout.astro';
import games from '../data/games.json';
import type { Game } from '../types';

export function getStaticPaths() {
  const gameList = games as Game[];
  return gameList.map((game) => ({
    params: { slug: game.slug },
    props: { game }
  }));
}

const { game } = Astro.props as { game: Game };
const showEmbed = Boolean(game.embedUrl);
const showFullScreen = Boolean(game.fullScreenUrl);
---

<BaseLayout title={game.title} description={`Play ${game.title} on Terapixel Games.`}>
  <section class="space-y-7">
    <h1 class="text-center text-4xl font-normal">{game.title}</h1>

    {
      showEmbed ? (
        <div class="mx-auto max-w-5xl overflow-hidden border border-zinc-800 bg-zinc-950 p-2">
          <div class="relative w-full" style="padding-top: 56.25%;">
            <iframe
              src={game.embedUrl as string}
              title={`${game.title} game`}
              class="absolute inset-0 h-full w-full"
              loading="lazy"
              allow="fullscreen"
              allowfullscreen
            />
          </div>
        </div>
      ) : (
        <p class="text-center text-zinc-400">Coming Soon</p>
      )
    }

    <div class="flex flex-wrap items-center justify-center gap-6 text-base">
      {
        showFullScreen ? (
          <a href={game.fullScreenUrl as string} target="_blank" rel="noreferrer noopener" class="underline underline-offset-4">
            Full Screen
          </a>
        ) : (
          <span class="text-zinc-400">Coming Soon</span>
        )
      }
      <a href="/games" class="underline underline-offset-4 text-zinc-300 hover:text-white">Back to Games</a>
    </div>
  </section>
</BaseLayout>